<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>GS Compare â€” BMW Motorrad</title>
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@300;400;600;700;900&family=Barlow:wght@300;400;500;600&display=swap" rel="stylesheet" />
<style>
  :root {
    --bmw-blue: #1C69D4;
    --bmw-blue-light: #4A8FE7;
    --bmw-blue-dark: #0E4FA8;
    --bg-0: #070A0F;
    --bg-1: #0D1117;
    --bg-2: #131920;
    --bg-3: #1A2231;
    --bg-card: #111827;
    --border: rgba(255,255,255,0.07);
    --border-blue: rgba(28,105,212,0.4);
    --text-primary: #F0F4FF;
    --text-secondary: #8899BB;
    --text-muted: #4A5870;
    --gold: #C9A84C;
    --red: #E84040;
    --green: #22C75E;
    --radius: 6px;
    --radius-lg: 12px;
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  html { scroll-behavior: smooth; }

  body {
    font-family: 'Barlow', sans-serif;
    background: var(--bg-0);
    color: var(--text-primary);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* â”€â”€ HEADER â”€â”€ */
  header {
    position: fixed; top: 0; left: 0; right: 0; z-index: 100;
    background: rgba(7,10,15,0.92);
    backdrop-filter: blur(16px);
    border-bottom: 1px solid var(--border);
  }
  .header-inner {
    max-width: 1400px; margin: 0 auto;
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 2rem; height: 64px;
  }
  .logo {
    display: flex; align-items: center; gap: 14px;
    text-decoration: none;
  }
  .logo-bmw {
    width: 40px; height: 40px;
    background: var(--bmw-blue);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    position: relative; overflow: hidden; flex-shrink: 0;
  }
  .logo-bmw::before {
    content: '';
    position: absolute; top: 50%; left: 0; right: 0;
    height: 2px; background: white;
    transform: translateY(-50%);
  }
  .logo-bmw::after {
    content: '';
    position: absolute; left: 50%; top: 0; bottom: 0;
    width: 2px; background: white;
    transform: translateX(-50%);
  }
  .logo-quad { position: absolute; inset: 0; display: grid; grid-template-columns: 1fr 1fr; }
  .logo-quad span:nth-child(1) { background: white; }
  .logo-quad span:nth-child(2) { background: var(--bmw-blue); }
  .logo-quad span:nth-child(3) { background: var(--bmw-blue); }
  .logo-quad span:nth-child(4) { background: white; }
  .logo-text { display: flex; flex-direction: column; line-height: 1; }
  .logo-text .brand { font-family: 'Barlow Condensed', sans-serif; font-weight: 900; font-size: 1.1rem; letter-spacing: 0.15em; color: white; }
  .logo-text .sub { font-family: 'Barlow Condensed', sans-serif; font-weight: 300; font-size: 0.65rem; letter-spacing: 0.3em; color: var(--text-secondary); }
  .header-actions { display: flex; gap: 0.5rem; align-items: center; }
  .badge-count {
    background: var(--bmw-blue); color: white;
    font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 0.7rem;
    letter-spacing: 0.05em;
    padding: 2px 8px; border-radius: 20px; display: none;
  }
  .badge-count.visible { display: inline-block; }

  /* â”€â”€ BTN â”€â”€ */
  .btn {
    display: inline-flex; align-items: center; gap: 6px;
    padding: 0.45rem 1rem; border-radius: var(--radius);
    font-family: 'Barlow Condensed', sans-serif; font-weight: 600; font-size: 0.85rem;
    letter-spacing: 0.08em; cursor: pointer; border: none; transition: all 0.2s;
    text-transform: uppercase;
  }
  .btn-primary { background: var(--bmw-blue); color: white; }
  .btn-primary:hover { background: var(--bmw-blue-light); }
  .btn-ghost { background: transparent; color: var(--text-secondary); border: 1px solid var(--border); }
  .btn-ghost:hover { border-color: var(--bmw-blue); color: var(--text-primary); }
  .btn-danger { background: transparent; color: var(--red); border: 1px solid rgba(232,64,64,0.3); }
  .btn-danger:hover { background: rgba(232,64,64,0.1); }
  .btn-sm { padding: 0.3rem 0.7rem; font-size: 0.75rem; }
  .btn-lg { padding: 0.75rem 1.8rem; font-size: 1rem; }

  /* â”€â”€ HERO / URL INPUT SECTION â”€â”€ */
  .hero {
    min-height: 100vh; display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    padding: 6rem 2rem 3rem;
    background:
      radial-gradient(ellipse 60% 50% at 50% -10%, rgba(28,105,212,0.18) 0%, transparent 60%),
      linear-gradient(180deg, var(--bg-0) 0%, var(--bg-1) 100%);
    position: relative;
  }
  .hero::before {
    content: 'GS';
    position: absolute; bottom: -0.1em; left: 50%;
    transform: translateX(-50%);
    font-family: 'Barlow Condensed', sans-serif; font-weight: 900; font-size: 22vw;
    color: rgba(255,255,255,0.018); line-height: 1; pointer-events: none;
    white-space: nowrap;
  }
  .hero-label {
    font-family: 'Barlow Condensed', sans-serif; font-weight: 300;
    font-size: 0.7rem; letter-spacing: 0.5em; color: var(--bmw-blue);
    text-transform: uppercase; margin-bottom: 1.2rem;
    animation: fadeUp 0.6s ease both;
  }
  .hero-title {
    font-family: 'Barlow Condensed', sans-serif; font-weight: 900;
    font-size: clamp(2.8rem, 6vw, 5rem);
    letter-spacing: -0.01em; line-height: 0.95;
    text-align: center; margin-bottom: 0.6rem;
    animation: fadeUp 0.6s 0.1s ease both;
  }
  .hero-title span { color: var(--bmw-blue); }
  .hero-sub {
    color: var(--text-secondary); font-size: 1rem; font-weight: 300;
    text-align: center; max-width: 480px; line-height: 1.6;
    margin-bottom: 3rem;
    animation: fadeUp 0.6s 0.2s ease both;
  }

  /* â”€â”€ URL INPUT CARD â”€â”€ */
  .url-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: 2rem;
    width: 100%; max-width: 700px;
    animation: fadeUp 0.6s 0.3s ease both;
    box-shadow: 0 32px 80px rgba(0,0,0,0.5);
  }
  .url-card h3 {
    font-family: 'Barlow Condensed', sans-serif; font-weight: 700;
    font-size: 0.75rem; letter-spacing: 0.3em; color: var(--text-secondary);
    text-transform: uppercase; margin-bottom: 1rem;
  }
  .url-row { display: flex; gap: 0.5rem; }
  .url-input {
    flex: 1;
    background: var(--bg-2); border: 1px solid var(--border);
    border-radius: var(--radius); color: var(--text-primary);
    font-family: 'Barlow', sans-serif; font-size: 0.9rem;
    padding: 0.65rem 1rem; outline: none;
    transition: border-color 0.2s;
  }
  .url-input:focus { border-color: var(--bmw-blue); }
  .url-input::placeholder { color: var(--text-muted); }

  .divider {
    display: flex; align-items: center; gap: 1rem;
    margin: 1.2rem 0;
    color: var(--text-muted); font-size: 0.75rem; letter-spacing: 0.1em;
  }
  .divider::before, .divider::after {
    content: ''; flex: 1; height: 1px; background: var(--border);
  }

  /* â”€â”€ MANUAL FORM â”€â”€ */
  .manual-form { display: none; }
  .manual-form.open { display: block; }
  .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
  .form-group { display: flex; flex-direction: column; gap: 0.3rem; }
  .form-group.full { grid-column: 1/-1; }
  .form-group label {
    font-size: 0.7rem; font-weight: 600; letter-spacing: 0.15em;
    text-transform: uppercase; color: var(--text-muted);
  }
  .form-group input, .form-group select, .form-group textarea {
    background: var(--bg-2); border: 1px solid var(--border);
    border-radius: var(--radius); color: var(--text-primary);
    font-family: 'Barlow', sans-serif; font-size: 0.9rem;
    padding: 0.55rem 0.8rem; outline: none;
    transition: border-color 0.2s;
  }
  .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
    border-color: var(--bmw-blue);
  }
  .form-group select { cursor: pointer; }
  .form-group option { background: var(--bg-2); }
  .star-row { display: flex; gap: 4px; }
  .star {
    font-size: 1.2rem; cursor: pointer; color: var(--text-muted);
    transition: color 0.15s;
  }
  .star.active, .star:hover { color: var(--gold); }

  /* â”€â”€ STATUS BAR â”€â”€ */
  .status-bar {
    margin-top: 1rem; padding: 0.6rem 1rem;
    border-radius: var(--radius); font-size: 0.82rem;
    display: none; align-items: center; gap: 0.5rem;
  }
  .status-bar.show { display: flex; }
  .status-bar.loading { background: rgba(28,105,212,0.1); border: 1px solid var(--border-blue); color: var(--bmw-blue-light); }
  .status-bar.success { background: rgba(34,199,94,0.08); border: 1px solid rgba(34,199,94,0.2); color: var(--green); }
  .status-bar.error { background: rgba(232,64,64,0.08); border: 1px solid rgba(232,64,64,0.2); color: var(--red); }
  .spinner {
    width: 14px; height: 14px; border: 2px solid transparent;
    border-top-color: currentColor; border-radius: 50%;
    animation: spin 0.7s linear infinite; flex-shrink: 0;
  }

  /* â”€â”€ COMPARISON SECTION â”€â”€ */
  .section {
    max-width: 1400px; margin: 0 auto;
    padding: 4rem 2rem;
  }
  .section-header {
    display: flex; align-items: flex-end; justify-content: space-between;
    margin-bottom: 2rem; padding-bottom: 1rem;
    border-bottom: 1px solid var(--border);
  }
  .section-title {
    font-family: 'Barlow Condensed', sans-serif; font-weight: 900;
    font-size: 2.2rem; letter-spacing: -0.01em;
    line-height: 1;
  }
  .section-title span { color: var(--bmw-blue); }
  .section-count {
    font-family: 'Barlow Condensed', sans-serif; font-weight: 300;
    font-size: 0.75rem; letter-spacing: 0.3em; color: var(--text-secondary);
    text-transform: uppercase;
  }

  /* â”€â”€ BIKE CARDS GRID â”€â”€ */
  .bikes-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-bottom: 3rem;
  }
  .bike-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    overflow: hidden;
    transition: border-color 0.25s, transform 0.25s;
    position: relative;
  }
  .bike-card:hover { border-color: rgba(28,105,212,0.5); transform: translateY(-3px); }
  .bike-card.best-value { border-color: rgba(201,168,76,0.4); }
  .bike-card.best-value::before {
    content: 'â˜… NEJLEPÅ Ã HODNOTA';
    position: absolute; top: 10px; right: 10px; z-index: 2;
    background: var(--gold); color: var(--bg-0);
    font-family: 'Barlow Condensed', sans-serif; font-weight: 700;
    font-size: 0.6rem; letter-spacing: 0.15em;
    padding: 3px 8px; border-radius: 3px;
  }
  .bike-photo {
    width: 100%; height: 200px; object-fit: cover;
    background: var(--bg-2);
    display: block;
  }
  .bike-photo-placeholder {
    width: 100%; height: 200px;
    background: var(--bg-2);
    display: flex; align-items: center; justify-content: center;
    color: var(--text-muted); font-size: 3rem;
  }
  .bike-body { padding: 1.2rem; }
  .bike-model {
    font-family: 'Barlow Condensed', sans-serif; font-weight: 900;
    font-size: 1.3rem; letter-spacing: -0.01em; margin-bottom: 0.2rem;
  }
  .bike-year-origin { font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.8rem; }
  .bike-price {
    font-family: 'Barlow Condensed', sans-serif; font-weight: 700;
    font-size: 1.6rem; color: var(--bmw-blue); margin-bottom: 0.8rem;
  }
  .bike-stats {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 0.5rem; margin-bottom: 1rem;
  }
  .bike-stat { display: flex; flex-direction: column; gap: 1px; }
  .bike-stat .label { font-size: 0.65rem; font-weight: 600; letter-spacing: 0.12em; color: var(--text-muted); text-transform: uppercase; }
  .bike-stat .value { font-size: 0.88rem; font-weight: 500; color: var(--text-primary); }
  .stk-badge {
    display: inline-flex; align-items: center; gap: 4px;
    font-size: 0.7rem; font-weight: 600; letter-spacing: 0.08em;
    padding: 2px 8px; border-radius: 3px; text-transform: uppercase;
  }
  .stk-ok { background: rgba(34,199,94,0.12); color: var(--green); border: 1px solid rgba(34,199,94,0.25); }
  .stk-warn { background: rgba(201,168,76,0.12); color: var(--gold); border: 1px solid rgba(201,168,76,0.25); }
  .stk-unknown { background: rgba(255,255,255,0.04); color: var(--text-muted); border: 1px solid var(--border); }
  .bike-stars { display: flex; gap: 3px; margin-bottom: 0.6rem; }
  .bike-stars span { font-size: 0.9rem; }
  .bike-notes {
    font-size: 0.78rem; color: var(--text-secondary); font-style: italic;
    border-left: 2px solid var(--border-blue);
    padding-left: 0.6rem; margin-bottom: 0.8rem;
    display: none;
  }
  .bike-notes.has-notes { display: block; }
  .bike-actions { display: flex; gap: 0.4rem; flex-wrap: wrap; }
  .bike-url-link {
    display: inline-flex; align-items: center; gap: 4px;
    font-size: 0.72rem; color: var(--bmw-blue); text-decoration: none;
    letter-spacing: 0.05em; font-weight: 600;
    transition: color 0.15s;
  }
  .bike-url-link:hover { color: var(--bmw-blue-light); }

  /* â”€â”€ COMPARISON TABLE â”€â”€ */
  .table-wrap {
    overflow-x: auto;
    border-radius: var(--radius-lg);
    border: 1px solid var(--border);
  }
  .comp-table {
    width: 100%; border-collapse: collapse;
    font-size: 0.88rem;
  }
  .comp-table thead {
    background: var(--bg-3);
  }
  .comp-table th {
    padding: 1rem 1.2rem; text-align: left;
    font-family: 'Barlow Condensed', sans-serif; font-weight: 700;
    font-size: 0.7rem; letter-spacing: 0.2em; text-transform: uppercase;
    color: var(--text-secondary); border-bottom: 1px solid var(--border);
    white-space: nowrap;
  }
  .comp-table td {
    padding: 0.85rem 1.2rem;
    border-bottom: 1px solid var(--border);
    vertical-align: middle;
  }
  .comp-table tr:last-child td { border-bottom: none; }
  .comp-table tr:hover td { background: rgba(28,105,212,0.04); }
  .comp-table .thumb {
    width: 64px; height: 44px; object-fit: cover;
    border-radius: 4px; display: block;
    background: var(--bg-2);
  }
  .comp-table .thumb-placeholder {
    width: 64px; height: 44px; border-radius: 4px;
    background: var(--bg-2); display: flex;
    align-items: center; justify-content: center;
    color: var(--text-muted); font-size: 1.2rem;
  }
  .comp-table .price-cell {
    font-family: 'Barlow Condensed', sans-serif; font-weight: 700;
    font-size: 1.1rem; color: var(--bmw-blue);
  }
  .val-best { color: var(--green); font-weight: 600; }
  .val-worst { color: var(--red); }
  .empty-state {
    text-align: center; padding: 5rem 2rem;
    display: none;
  }
  .empty-state.visible { display: block; }
  .empty-state .icon { font-size: 4rem; margin-bottom: 1rem; opacity: 0.3; }
  .empty-state p { color: var(--text-secondary); font-size: 0.95rem; line-height: 1.6; }

  /* â”€â”€ PHOTO GALLERY â”€â”€ */
  .photos-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 0.5rem; margin-top: 0.8rem;
  }
  .photo-thumb {
    width: 100%; aspect-ratio: 4/3;
    object-fit: cover; border-radius: 4px;
    cursor: pointer; transition: opacity 0.2s;
    border: 1px solid var(--border);
  }
  .photo-thumb:hover { opacity: 0.8; }

  /* â”€â”€ LIGHTBOX â”€â”€ */
  .lightbox {
    display: none; position: fixed; inset: 0; z-index: 999;
    background: rgba(0,0,0,0.92);
    align-items: center; justify-content: center;
  }
  .lightbox.open { display: flex; }
  .lightbox img { max-width: 90vw; max-height: 85vh; border-radius: var(--radius); }
  .lightbox-close {
    position: absolute; top: 1.5rem; right: 1.5rem;
    background: rgba(255,255,255,0.1); border: none; color: white;
    width: 40px; height: 40px; border-radius: 50%; font-size: 1.2rem;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    transition: background 0.2s;
  }
  .lightbox-close:hover { background: rgba(255,255,255,0.2); }

  /* â”€â”€ TOAST â”€â”€ */
  .toast-container { position: fixed; bottom: 1.5rem; right: 1.5rem; z-index: 200; display: flex; flex-direction: column; gap: 0.5rem; }
  .toast {
    background: var(--bg-3); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 0.7rem 1.2rem;
    font-size: 0.85rem; display: flex; align-items: center; gap: 0.5rem;
    animation: slideIn 0.3s ease; max-width: 320px;
  }
  .toast.success { border-color: rgba(34,199,94,0.3); color: var(--green); }
  .toast.error { border-color: rgba(232,64,64,0.3); color: var(--red); }
  .toast.info { border-color: var(--border-blue); color: var(--bmw-blue-light); }

  /* â”€â”€ FEATURES NOTE â”€â”€ */
  .features-list {
    background: var(--bg-card); border: 1px solid var(--border);
    border-radius: var(--radius-lg); padding: 1.5rem 2rem;
    margin-top: 3rem;
  }
  .features-list h4 {
    font-family: 'Barlow Condensed', sans-serif; font-weight: 700;
    font-size: 0.7rem; letter-spacing: 0.3em; color: var(--text-muted);
    text-transform: uppercase; margin-bottom: 1rem;
  }
  .features-chips { display: flex; flex-wrap: wrap; gap: 0.5rem; }
  .chip {
    padding: 4px 12px; border-radius: 20px;
    font-size: 0.75rem; font-weight: 500;
    display: inline-flex; align-items: center; gap: 4px;
  }
  .chip-blue { background: rgba(28,105,212,0.12); border: 1px solid var(--border-blue); color: var(--bmw-blue-light); }
  .chip-gold { background: rgba(201,168,76,0.1); border: 1px solid rgba(201,168,76,0.3); color: var(--gold); }
  .chip-note { background: rgba(255,255,255,0.04); border: 1px solid var(--border); color: var(--text-secondary); }

  /* â”€â”€ SORTING BAR â”€â”€ */
  .sort-bar { display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1.5rem; }
  .sort-bar label { font-size: 0.75rem; color: var(--text-secondary); letter-spacing: 0.1em; text-transform: uppercase; font-weight: 600; }
  .sort-btn {
    padding: 0.3rem 0.8rem;
    border-radius: 20px; border: 1px solid var(--border);
    background: transparent; color: var(--text-secondary);
    font-family: 'Barlow Condensed', sans-serif; font-weight: 600;
    font-size: 0.75rem; letter-spacing: 0.1em; cursor: pointer;
    transition: all 0.15s;
  }
  .sort-btn.active, .sort-btn:hover { background: var(--bmw-blue); border-color: var(--bmw-blue); color: white; }

  /* â”€â”€ FOOTER â”€â”€ */
  footer {
    border-top: 1px solid var(--border);
    padding: 1.5rem 2rem;
    text-align: center;
    color: var(--text-muted); font-size: 0.75rem; letter-spacing: 0.1em;
  }
  footer a { color: var(--bmw-blue); text-decoration: none; }

  /* â”€â”€ ANIMATIONS â”€â”€ */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  @keyframes slideIn {
    from { opacity: 0; transform: translateX(20px); }
    to { opacity: 1; transform: translateX(0); }
  }
  @keyframes fadeOut {
    to { opacity: 0; transform: translateX(20px); }
  }

  /* â”€â”€ RESPONSIVE â”€â”€ */
  @media (max-width: 640px) {
    .header-inner { padding: 0 1rem; }
    .hero { padding: 5rem 1rem 2rem; }
    .section { padding: 2.5rem 1rem; }
    .section-header { flex-direction: column; align-items: flex-start; gap: 0.5rem; }
    .form-grid { grid-template-columns: 1fr; }
    .bikes-grid { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<!-- â”€â”€ HEADER â”€â”€ -->
<header>
  <div class="header-inner">
    <a class="logo" href="#">
      <div class="logo-bmw" aria-hidden="true">
        <div class="logo-quad">
          <span></span><span></span><span></span><span></span>
        </div>
      </div>
      <div class="logo-text">
        <span class="brand">BMW MOTORRAD</span>
        <span class="sub">GS Compare</span>
      </div>
    </a>
    <div class="header-actions">
      <span id="headerCount" class="badge-count">0 motocyklÅ¯</span>
      <button class="btn btn-ghost btn-sm" onclick="exportCSV()">â¬‡ Export CSV</button>
      <button class="btn btn-ghost btn-sm" onclick="clearAll()">ğŸ—‘ Vymazat vÅ¡e</button>
      <a href="#compare" class="btn btn-primary btn-sm">Srovnat â†’</a>
    </div>
  </div>
</header>

<!-- â”€â”€ HERO â”€â”€ -->
<main>
<section class="hero" id="home">
  <p class="hero-label">BMW Motorrad â€” GS Adventure Series</p>
  <h1 class="hero-title">Porovnej <span>svÅ¯j</span><br/>pÅ™Ã­Å¡tÃ­ GS</h1>
  <p class="hero-sub">VloÅ¾ URL inzerÃ¡tu, aplikace automaticky naÄte data a pÅ™idÃ¡ motocykl do srovnÃ¡vacÃ­ tabulky.</p>

  <!-- URL CARD -->
  <div class="url-card">
    <h3>ğŸ”— NaÄÃ­st z URL</h3>
    <div class="url-row">
      <input type="url" class="url-input" id="urlInput"
        placeholder="https://www.sauto.cz/inzerce/detail/... nebo tipcars.com, bazos.cz..."
        onkeydown="if(event.key==='Enter') fetchBike()"/>
      <button class="btn btn-primary btn-lg" onclick="fetchBike()">NaÄÃ­st</button>
    </div>
    <div id="statusBar" class="status-bar"></div>

    <div class="divider">nebo vyplnit ruÄnÄ›</div>

    <button class="btn btn-ghost" onclick="toggleManual()">+ PÅ™idat manuÃ¡lnÄ›</button>

    <div id="manualForm" class="manual-form">
      <div class="form-grid" style="margin-top:1rem">
        <div class="form-group full">
          <label>Model / nÃ¡zev</label>
          <input type="text" id="f_model" placeholder="BMW R 1250 GS Adventure" />
        </div>
        <div class="form-group">
          <label>Rok vÃ½roby</label>
          <input type="number" id="f_year" placeholder="2021" min="1990" max="2025" />
        </div>
        <div class="form-group">
          <label>Cena (KÄ)</label>
          <input type="number" id="f_price" placeholder="450000" />
        </div>
        <div class="form-group">
          <label>NajetÃ© km</label>
          <input type="number" id="f_km" placeholder="35000" />
        </div>
        <div class="form-group">
          <label>PÅ¯vod</label>
          <select id="f_origin">
            <option value="">â€” NevÃ­m â€”</option>
            <option value="CZ">ğŸ‡¨ğŸ‡¿ ÄŒeskÃ¡ republika</option>
            <option value="SK">ğŸ‡¸ğŸ‡° Slovensko</option>
            <option value="DE">ğŸ‡©ğŸ‡ª NÄ›mecko</option>
            <option value="AT">ğŸ‡¦ğŸ‡¹ Rakousko</option>
            <option value="PL">ğŸ‡µğŸ‡± Polsko</option>
            <option value="HU">ğŸ‡­ğŸ‡º MaÄarsko</option>
            <option value="IT">ğŸ‡®ğŸ‡¹ ItÃ¡lie</option>
            <option value="FR">ğŸ‡«ğŸ‡· Francie</option>
            <option value="GB">ğŸ‡¬ğŸ‡§ VelkÃ¡ BritÃ¡nie</option>
            <option value="US">ğŸ‡ºğŸ‡¸ USA</option>
            <option value="Other">ğŸŒ JinÃ½</option>
          </select>
        </div>
        <div class="form-group">
          <label>STK platnÃ¡ do</label>
          <input type="month" id="f_stk" />
        </div>
        <div class="form-group">
          <label>VÃ½kon (kW)</label>
          <input type="number" id="f_power" placeholder="100" />
        </div>
        <div class="form-group">
          <label>Objem (ccm)</label>
          <input type="number" id="f_ccm" placeholder="1254" />
        </div>
        <div class="form-group full">
          <label>URL inzerÃ¡tu</label>
          <input type="url" id="f_url" placeholder="https://..." />
        </div>
        <div class="form-group full">
          <label>URL nÃ¡hledovÃ© fotografie</label>
          <input type="url" id="f_photo" placeholder="https://...foto.jpg" />
        </div>
        <div class="form-group full">
          <label>PoznÃ¡mky / postÅ™ehy</label>
          <textarea id="f_notes" rows="2" placeholder="ServisnÃ­ knÃ­Å¾ka, pÅ™Ã­sluÅ¡enstvÃ­, dojmy..."></textarea>
        </div>
        <div class="form-group full">
          <label>HodnocenÃ­</label>
          <div class="star-row" id="starRow">
            <span class="star" data-v="1">â˜…</span>
            <span class="star" data-v="2">â˜…</span>
            <span class="star" data-v="3">â˜…</span>
            <span class="star" data-v="4">â˜…</span>
            <span class="star" data-v="5">â˜…</span>
          </div>
        </div>
        <div class="form-group full" style="justify-content: flex-end; flex-direction: row; gap: 0.5rem;">
          <button class="btn btn-ghost" onclick="toggleManual()">ZruÅ¡it</button>
          <button class="btn btn-primary" onclick="addManual()">PÅ™idat do srovnÃ¡nÃ­ â†’</button>
        </div>
      </div>
    </div>
  </div><!-- /url-card -->

  <!-- FEATURES NOTE -->
  <div class="features-list" style="max-width:700px;width:100%">
    <h4>âœ“ Funkce aplikace</h4>
    <div class="features-chips">
      <span class="chip chip-blue">ğŸ”— NaÄtenÃ­ z URL (sauto, tipcars, bazos...)</span>
      <span class="chip chip-blue">ğŸ–¼ StaÅ¾enÃ­ fotek inzerÃ¡tu</span>
      <span class="chip chip-blue">ğŸ“Š SrovnÃ¡vacÃ­ tabulka</span>
      <span class="chip chip-blue">ğŸ’¾ UklÃ¡dÃ¡nÃ­ v prohlÃ­Å¾eÄi (localStorage)</span>
      <span class="chip chip-gold">â¬‡ Export do CSV</span>
      <span class="chip chip-gold">â˜… HodnocenÃ­ motocyklu</span>
      <span class="chip chip-gold">ğŸ“ OsobnÃ­ poznÃ¡mky</span>
      <span class="chip chip-gold">ğŸ† OznaÄenÃ­ nejlepÅ¡Ã­ hodnoty</span>
      <span class="chip chip-note">âš  Scraping pÅ™es CORS proxy (omezenÃ­ dle zdroje)</span>
      <span class="chip chip-note">ğŸ“± ResponzivnÃ­ design</span>
    </div>
  </div>
</section>

<!-- â”€â”€ COMPARISON SECTION â”€â”€ -->
<section class="section" id="compare">
  <div class="section-header">
    <div>
      <div class="section-title">SrovnÃ¡nÃ­ <span>GS</span></div>
      <div class="section-count" id="bikeCount">0 motocyklÅ¯ v databÃ¡zi</div>
    </div>
    <div class="sort-bar">
      <label>Å˜adit:</label>
      <button class="sort-btn active" data-sort="added">PÅ™idÃ¡no</button>
      <button class="sort-btn" data-sort="price_asc">Cena â†‘</button>
      <button class="sort-btn" data-sort="price_desc">Cena â†“</button>
      <button class="sort-btn" data-sort="km">Km â†‘</button>
      <button class="sort-btn" data-sort="year">Rok â†“</button>
      <button class="sort-btn" data-sort="rating">HodnocenÃ­</button>
    </div>
  </div>

  <!-- CARDS -->
  <div id="bikesGrid" class="bikes-grid"></div>

  <div id="emptyState" class="empty-state">
    <div class="icon">ğŸ</div>
    <p>Å½Ã¡dnÃ© motocykly zatÃ­m.<br/>VloÅ¾ URL inzerÃ¡tu nebo pÅ™idej manuÃ¡lnÄ›.</p>
  </div>

  <!-- TABLE -->
  <div id="tableSection" style="display:none">
    <div class="section-header" style="margin-top:2rem">
      <div class="section-title" style="font-size:1.5rem">PÅ™ehledovÃ¡ <span>tabulka</span></div>
    </div>
    <div class="table-wrap">
      <table class="comp-table">
        <thead>
          <tr>
            <th>Foto</th>
            <th>Model</th>
            <th>Rok</th>
            <th>Cena</th>
            <th>Km</th>
            <th>PÅ¯vod</th>
            <th>STK</th>
            <th>VÃ½kon</th>
            <th>Objem</th>
            <th>HodnocenÃ­</th>
            <th>Zdroj</th>
          </tr>
        </thead>
        <tbody id="compTableBody"></tbody>
      </table>
    </div>
  </div>
</section>
</main>

<!-- FOOTER -->
<footer>
  <p>GS Compare â€” neoficiÃ¡lnÃ­ nÃ¡stroj pro nadÅ¡ence BMW Motorrad &nbsp;Â·&nbsp;
  <a href="https://github.com/davebiker/bike-compare" target="_blank">github.com/davebiker/bike-compare</a></p>
</footer>

<!-- LIGHTBOX -->
<div class="lightbox" id="lightbox" onclick="closeLightbox()">
  <button class="lightbox-close" onclick="closeLightbox()">âœ•</button>
  <img id="lightboxImg" src="" alt="Photo" />
</div>

<!-- TOAST CONTAINER -->
<div class="toast-container" id="toastContainer"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let bikes = JSON.parse(localStorage.getItem('gs_compare_bikes') || '[]');
let manualRating = 0;
let currentSort = 'added';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('DOMContentLoaded', () => {
  renderAll();
  initSortBtns();
  initStars();
});

function save() {
  localStorage.setItem('gs_compare_bikes', JSON.stringify(bikes));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FETCH FROM URL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function fetchBike() {
  const url = document.getElementById('urlInput').value.trim();
  if (!url) { toast('VloÅ¾ URL inzerÃ¡tu', 'error'); return; }

  setStatus('loading', 'NaÄÃ­tÃ¡m strÃ¡nku inzerÃ¡tuâ€¦');

  // CORS proxies (fallback chain)
  const proxies = [
    u => `https://api.allorigins.win/get?url=${encodeURIComponent(u)}`,
    u => `https://corsproxy.io/?${encodeURIComponent(u)}`
  ];

  let html = null;
  for (const proxy of proxies) {
    try {
      const res = await fetch(proxy(url), { signal: AbortSignal.timeout(12000) });
      if (!res.ok) continue;
      const data = await res.json().catch(() => null);
      if (data && data.contents) { html = data.contents; break; }
      const text = await res.text().catch(() => null);
      if (text && text.length > 500) { html = text; break; }
    } catch(e) { continue; }
  }

  if (!html) {
    setStatus('error', 'NepodaÅ™ilo se naÄÃ­st strÃ¡nku. Zkus pÅ™idat motocykl ruÄnÄ›.');
    return;
  }

  setStatus('loading', 'Parsuju data z inzerÃ¡tuâ€¦');
  const bike = parseMotorcycleData(html, url);

  if (!bike.model) {
    setStatus('error', 'NepodaÅ™ilo se rozpoznat model. PÅ™idej motocykl ruÄnÄ›.');
    return;
  }

  bikes.push(bike);
  save();
  renderAll();
  setStatus('success', `âœ“ PÅ™idÃ¡no: ${bike.model} (${bike.year || '?'}) â€” ${formatPrice(bike.price)}`);
  document.getElementById('urlInput').value = '';
  document.getElementById('compare').scrollIntoView({ behavior: 'smooth' });
  toast(`${bike.model} pÅ™idÃ¡n do srovnÃ¡nÃ­`, 'success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PARSER â€” pokryje sauto.cz, tipcars.com, bazos.cz, mobile.de
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function parseMotorcycleData(html, url) {
  const parser = new DOMParser();
  const doc = parser.parseFromString(html, 'text/html');
  const text = doc.body ? doc.body.innerText || doc.body.textContent : html;

  const bike = {
    id: Date.now(),
    url,
    model: null, year: null, price: null, km: null,
    origin: null, stk: null, power: null, ccm: null,
    photos: [], notes: '', rating: 0, added: Date.now()
  };

  // â”€â”€ MODEL â”€â”€
  const titleCandidates = [
    doc.querySelector('h1'),
    doc.querySelector('[class*="title"]'),
    doc.querySelector('[class*="heading"]'),
    doc.querySelector('meta[property="og:title"]'),
    doc.querySelector('meta[name="title"]'),
  ];
  for (const el of titleCandidates) {
    const t = el ? (el.getAttribute('content') || el.textContent || '').trim() : '';
    if (t.length > 3) { bike.model = cleanModel(t); break; }
  }
  if (!bike.model) {
    const m = text.match(/BMW\s+[A-Z]\s*\d{3,4}\s*(?:GS|Adventure|R|F|S|G|K)[^,\n]*/i);
    if (m) bike.model = cleanModel(m[0]);
  }

  // â”€â”€ YEAR â”€â”€
  const yearM = text.match(/\b(19[89]\d|20[012]\d)\b/);
  if (yearM) bike.year = parseInt(yearM[1]);

  // â”€â”€ PRICE â”€â”€
  const priceM = text.match(/(\d[\d\s\.]+)\s*(?:KÄ|CZK|EUR|â‚¬|,-)/i);
  if (priceM) bike.price = parseInt(priceM[1].replace(/[\s\.]/g, ''));

  // â”€â”€ KM â”€â”€
  const kmM = text.match(/(\d[\d\s]+)\s*(?:km|kilomet)/i);
  if (kmM) bike.km = parseInt(kmM[1].replace(/\s/g, ''));

  // â”€â”€ ORIGIN â”€â”€
  const origins = { CZ:'ÄŒeskÃ¡ republika', SK:'Slovensko', DE:'NÄ›mecko', AT:'Rakousko', PL:'Polsko', HU:'MaÄarsko', IT:'ItÃ¡lie', FR:'Francie', GB:'VelkÃ¡ BritÃ¡nie' };
  for (const [code, name] of Object.entries(origins)) {
    if (text.includes(name)) { bike.origin = code; break; }
  }

  // â”€â”€ STK â”€â”€
  const stkM = text.match(/STK[^0-9]*(\d{1,2}[\/\.\-]\d{2,4})/i);
  if (stkM) bike.stk = stkM[1];

  // â”€â”€ POWER â”€â”€
  const pwM = text.match(/(\d{2,3})\s*(?:kW|KW)/);
  if (pwM) bike.power = parseInt(pwM[1]);
  const hpM = text.match(/(\d{2,3})\s*(?:k|ps|hp|ks)\b/i);
  if (hpM && !bike.power) bike.power = Math.round(parseInt(hpM[1]) * 0.7355);

  // â”€â”€ CCM â”€â”€
  const ccmM = text.match(/(\d{3,4})\s*(?:ccm|cm3|cc)\b/i);
  if (ccmM) bike.ccm = parseInt(ccmM[1]);

  // â”€â”€ PHOTOS â”€â”€
  const imgs = [...doc.querySelectorAll('img')];
  const photoUrls = [];
  for (const img of imgs) {
    const src = img.dataset.src || img.dataset.original || img.getAttribute('src') || '';
    if (!src || src.startsWith('data:') || src.length < 10) continue;
    if (/thumb|icon|logo|sprite|pixel|placeholder/i.test(src)) continue;
    const abs = toAbsolute(src, url);
    if (abs && !photoUrls.includes(abs)) photoUrls.push(abs);
    if (photoUrls.length >= 12) break;
  }
  // OG image
  const og = doc.querySelector('meta[property="og:image"]');
  if (og) {
    const ogsrc = og.getAttribute('content');
    if (ogsrc && !photoUrls.includes(ogsrc)) photoUrls.unshift(ogsrc);
  }
  bike.photos = photoUrls;

  return bike;
}

function cleanModel(s) {
  return s.replace(/\s+/g, ' ').replace(/\|.*$/, '').replace(/â€“.*$/, '').replace(/\d{5,}/g,'').trim().slice(0,80);
}

function toAbsolute(src, base) {
  try {
    if (src.startsWith('http')) return src;
    return new URL(src, base).href;
  } catch { return null; }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MANUAL ADD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleManual() {
  const f = document.getElementById('manualForm');
  f.classList.toggle('open');
}

function addManual() {
  const model = document.getElementById('f_model').value.trim();
  if (!model) { toast('VyplÅˆ alespoÅˆ model', 'error'); return; }

  const stkVal = document.getElementById('f_stk').value;
  const photoUrl = document.getElementById('f_photo').value.trim();

  const bike = {
    id: Date.now(),
    url: document.getElementById('f_url').value.trim(),
    model,
    year: parseInt(document.getElementById('f_year').value) || null,
    price: parseInt(document.getElementById('f_price').value) || null,
    km: parseInt(document.getElementById('f_km').value) || null,
    origin: document.getElementById('f_origin').value || null,
    stk: stkVal || null,
    power: parseInt(document.getElementById('f_power').value) || null,
    ccm: parseInt(document.getElementById('f_ccm').value) || null,
    photos: photoUrl ? [photoUrl] : [],
    notes: document.getElementById('f_notes').value.trim(),
    rating: manualRating,
    added: Date.now()
  };

  bikes.push(bike);
  save();
  renderAll();
  toggleManual();
  clearManualForm();
  toast(`${bike.model} pÅ™idÃ¡n`, 'success');
  document.getElementById('compare').scrollIntoView({ behavior: 'smooth' });
}

function clearManualForm() {
  ['f_model','f_year','f_price','f_km','f_power','f_ccm','f_url','f_photo','f_notes'].forEach(id => {
    document.getElementById(id).value = '';
  });
  document.getElementById('f_origin').value = '';
  document.getElementById('f_stk').value = '';
  manualRating = 0;
  updateStars(0);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STAR RATING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initStars() {
  document.querySelectorAll('#starRow .star').forEach(star => {
    star.addEventListener('click', () => {
      manualRating = parseInt(star.dataset.v);
      updateStars(manualRating);
    });
  });
}
function updateStars(val) {
  document.querySelectorAll('#starRow .star').forEach(s => {
    s.classList.toggle('active', parseInt(s.dataset.v) <= val);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function getSorted() {
  const b = [...bikes];
  switch(currentSort) {
    case 'price_asc': return b.sort((a,z) => (a.price||Infinity)-(z.price||Infinity));
    case 'price_desc': return b.sort((a,z) => (z.price||0)-(a.price||0));
    case 'km': return b.sort((a,z) => (a.km||Infinity)-(z.km||Infinity));
    case 'year': return b.sort((a,z) => (z.year||0)-(a.year||0));
    case 'rating': return b.sort((a,z) => (z.rating||0)-(a.rating||0));
    default: return b.sort((a,z) => a.added - z.added);
  }
}

function renderAll() {
  updateHeader();
  renderCards();
  renderTable();
}

function updateHeader() {
  const n = bikes.length;
  const el = document.getElementById('headerCount');
  el.textContent = `${n} motocykl${n===1?'':'Å¯'}`;
  el.classList.toggle('visible', n > 0);
  document.getElementById('bikeCount').textContent = `${n} motocykl${n===1?'':'n===2||n===3||n===4?'y':'Å¯'} v databÃ¡zi`;
}

// find best value (lowest price & km combo)
function getBestValue() {
  const withBoth = bikes.filter(b => b.price && b.km);
  if (withBoth.length < 2) return null;
  return withBoth.reduce((best, b) => {
    const score = (b.price / 100000) + (b.km / 10000);
    const bScore = (best.price / 100000) + (best.km / 10000);
    return score < bScore ? b : best;
  });
}

function renderCards() {
  const grid = document.getElementById('bikesGrid');
  const empty = document.getElementById('emptyState');
  const sorted = getSorted();
  const best = getBestValue();

  if (!sorted.length) {
    grid.innerHTML = '';
    empty.classList.add('visible');
    return;
  }
  empty.classList.remove('visible');

  grid.innerHTML = sorted.map(bike => {
    const isBest = best && best.id === bike.id;
    const photo = bike.photos?.[0];
    const stk = stkBadge(bike.stk);

    return `
    <div class="bike-card${isBest ? ' best-value' : ''}" id="card-${bike.id}">
      ${photo
        ? `<img class="bike-photo" src="${photo}" alt="${bike.model}" onerror="this.style.display='none';this.nextElementSibling.style.display='flex'" loading="lazy"/><div class="bike-photo-placeholder" style="display:none">ğŸ</div>`
        : `<div class="bike-photo-placeholder">ğŸ</div>`}
      <div class="bike-body">
        <div class="bike-model">${bike.model}</div>
        <div class="bike-year-origin">${bike.year || '?'} ${bike.origin ? 'Â· ' + flagOf(bike.origin) + ' ' + bike.origin : ''}</div>
        <div class="bike-price">${formatPrice(bike.price)}</div>
        <div class="bike-stats">
          <div class="bike-stat"><span class="label">NajetÃ© km</span><span class="value">${bike.km ? bike.km.toLocaleString('cs-CZ') + ' km' : 'â€”'}</span></div>
          <div class="bike-stat"><span class="label">STK</span><span class="value">${stk}</span></div>
          <div class="bike-stat"><span class="label">VÃ½kon</span><span class="value">${bike.power ? bike.power + ' kW' : 'â€”'}</span></div>
          <div class="bike-stat"><span class="label">Objem</span><span class="value">${bike.ccm ? bike.ccm + ' ccm' : 'â€”'}</span></div>
        </div>
        ${bike.rating ? `<div class="bike-stars">${'â˜…'.repeat(bike.rating)}<span style="color:var(--text-muted)">${'â˜…'.repeat(5-bike.rating)}</span></div>` : ''}
        <div class="bike-notes${bike.notes ? ' has-notes' : ''}">${bike.notes || ''}</div>
        ${bike.photos && bike.photos.length > 1 ? renderThumbs(bike) : ''}
        <div class="bike-actions" style="margin-top:0.6rem">
          ${bike.url ? `<a href="${bike.url}" class="bike-url-link" target="_blank">â†— InzerÃ¡t</a>` : ''}
          <button class="btn btn-ghost btn-sm" onclick="editNotes(${bike.id})">âœ PoznÃ¡mky</button>
          <button class="btn btn-danger btn-sm" onclick="removeBike(${bike.id})">âœ•</button>
        </div>
      </div>
    </div>`;
  }).join('');
}

function renderThumbs(bike) {
  const shown = bike.photos.slice(0, 6);
  return `<div class="photos-grid">${shown.map(p =>
    `<img class="photo-thumb" src="${p}" loading="lazy" onclick="openLightbox('${p}')" />`
  ).join('')}${bike.photos.length > 6 ? `<div style="display:flex;align-items:center;justify-content:center;font-size:0.8rem;color:var(--text-muted)">+${bike.photos.length-6} fotek</div>` : ''}</div>`;
}

function renderTable() {
  const tbody = document.getElementById('compTableBody');
  const tableSection = document.getElementById('tableSection');
  const sorted = getSorted();

  if (!sorted.length) { tableSection.style.display = 'none'; return; }
  tableSection.style.display = 'block';

  // highlight min/max
  const prices = sorted.map(b => b.price).filter(Boolean);
  const kms = sorted.map(b => b.km).filter(Boolean);
  const minPrice = Math.min(...prices);
  const maxPrice = Math.max(...prices);
  const minKm = Math.min(...kms);
  const maxKm = Math.max(...kms);

  tbody.innerHTML = sorted.map(bike => {
    const photo = bike.photos?.[0];
    const pClass = bike.price === minPrice && prices.length > 1 ? 'val-best' : bike.price === maxPrice && prices.length > 1 ? 'val-worst' : '';
    const kClass = bike.km === minKm && kms.length > 1 ? 'val-best' : bike.km === maxKm && kms.length > 1 ? 'val-worst' : '';

    return `<tr>
      <td>${photo
        ? `<img class="thumb" src="${photo}" onerror="this.style.display='none'" loading="lazy"/>`
        : `<div class="thumb-placeholder">ğŸ</div>`}
      </td>
      <td><strong>${bike.model}</strong></td>
      <td>${bike.year || 'â€”'}</td>
      <td class="price-cell ${pClass}">${formatPrice(bike.price)}</td>
      <td class="${kClass}">${bike.km ? bike.km.toLocaleString('cs-CZ') + ' km' : 'â€”'}</td>
      <td>${bike.origin ? flagOf(bike.origin) + ' ' + bike.origin : 'â€”'}</td>
      <td>${stkBadge(bike.stk)}</td>
      <td>${bike.power ? bike.power + ' kW' : 'â€”'}</td>
      <td>${bike.ccm ? bike.ccm + ' ccm' : 'â€”'}</td>
      <td>${bike.rating ? 'â˜…'.repeat(bike.rating) : 'â€”'}</td>
      <td>${bike.url ? `<a href="${bike.url}" class="bike-url-link" target="_blank">â†— Odkaz</a>` : 'â€”'}</td>
    </tr>`;
  }).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function formatPrice(p) {
  if (!p) return 'â€”';
  return p.toLocaleString('cs-CZ') + ' KÄ';
}

function stkBadge(stk) {
  if (!stk) return '<span class="stk-badge stk-unknown">neznÃ¡mÃ¡</span>';
  const d = parseSTK(stk);
  if (!d) return `<span class="stk-badge stk-unknown">${stk}</span>`;
  const now = new Date();
  const diff = (d - now) / (1000*60*60*24*30);
  if (diff < 0) return `<span class="stk-badge stk-warn">âš  ExpirovanÃ¡</span>`;
  if (diff < 3) return `<span class="stk-badge stk-warn">âš  ${stk}</span>`;
  return `<span class="stk-badge stk-ok">âœ“ ${stk}</span>`;
}

function parseSTK(s) {
  if (!s) return null;
  const m = s.match(/(\d{1,2})[\/\.\-](\d{2,4})/);
  if (!m) return null;
  const month = parseInt(m[1]) - 1;
  const year = m[2].length === 2 ? 2000 + parseInt(m[2]) : parseInt(m[2]);
  return new Date(year, month);
}

function flagOf(code) {
  const flags = {CZ:'ğŸ‡¨ğŸ‡¿',SK:'ğŸ‡¸ğŸ‡°',DE:'ğŸ‡©ğŸ‡ª',AT:'ğŸ‡¦ğŸ‡¹',PL:'ğŸ‡µğŸ‡±',HU:'ğŸ‡­ğŸ‡º',IT:'ğŸ‡®ğŸ‡¹',FR:'ğŸ‡«ğŸ‡·',GB:'ğŸ‡¬ğŸ‡§',US:'ğŸ‡ºğŸ‡¸',Other:'ğŸŒ'};
  return flags[code] || '';
}

function setStatus(type, msg) {
  const el = document.getElementById('statusBar');
  el.className = 'status-bar show ' + type;
  el.innerHTML = type === 'loading'
    ? `<div class="spinner"></div>${msg}`
    : (type === 'success' ? 'âœ“ ' : 'âœ• ') + msg;
}

function removeBike(id) {
  bikes = bikes.filter(b => b.id !== id);
  save(); renderAll();
  toast('Motocykl odebrÃ¡n', 'info');
}

function clearAll() {
  if (!bikes.length) return;
  if (!confirm('Opravdu vymazat vÅ¡echny motocykly?')) return;
  bikes = []; save(); renderAll();
  toast('DatabÃ¡ze vymazÃ¡na', 'info');
}

function editNotes(id) {
  const bike = bikes.find(b => b.id === id);
  if (!bike) return;
  const note = prompt('PoznÃ¡mky k motocyklu:', bike.notes || '');
  if (note === null) return;
  bike.notes = note;
  save(); renderAll();
}

function exportCSV() {
  if (!bikes.length) { toast('Å½Ã¡dnÃ¡ data k exportu', 'error'); return; }
  const cols = ['Model','Rok','Cena (KÄ)','Km','PÅ¯vod','STK','VÃ½kon (kW)','Objem (ccm)','HodnocenÃ­','URL'];
  const rows = bikes.map(b => [
    `"${b.model}"`, b.year||'', b.price||'', b.km||'', b.origin||'', b.stk||'', b.power||'', b.ccm||'', b.rating||'', `"${b.url||''}"`
  ].join(';'));
  const csv = [cols.join(';'), ...rows].join('\n');
  const blob = new Blob(['\uFEFF'+csv], {type:'text/csv;charset=utf-8;'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = `gs-compare-${new Date().toISOString().slice(0,10)}.csv`;
  a.click();
  toast('CSV exportovÃ¡no', 'success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SORT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initSortBtns() {
  document.querySelectorAll('.sort-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      currentSort = btn.dataset.sort;
      document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      renderAll();
    });
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LIGHTBOX
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openLightbox(src) {
  document.getElementById('lightboxImg').src = src;
  document.getElementById('lightbox').classList.add('open');
}
function closeLightbox() {
  document.getElementById('lightbox').classList.remove('open');
}
document.addEventListener('keydown', e => { if (e.key === 'Escape') closeLightbox(); });

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toast(msg, type = 'info') {
  const el = document.createElement('div');
  el.className = `toast ${type}`;
  const icon = {success:'âœ“', error:'âœ•', info:'â„¹'}[type] || 'â„¹';
  el.innerHTML = `<span>${icon}</span> ${msg}`;
  document.getElementById('toastContainer').appendChild(el);
  setTimeout(() => { el.style.animation = 'fadeOut 0.3s forwards'; setTimeout(() => el.remove(), 300); }, 3000);
}
</script>
</body>
</html>
